<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Collection - MongoDB PHP library</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Collection";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 
  <script src="../../pretty.js"></script>

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MongoDB PHP library</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../getting-started/">Getting Started</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../example-data/">Example Data</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Classes</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../client/">Client</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../database/">Database</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Collection</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#mongodbcollection">MongoDB\Collection</a></li>
                
                    <li><a class="toctree-l4" href="#collection-level-operations">Collection-level Operations</a></li>
                
                    <li><a class="toctree-l4" href="#crud-operations">CRUD Operations</a></li>
                
                    <li><a class="toctree-l4" href="#index-management">Index Management</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MongoDB PHP library</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Classes &raquo;</li>
        
      
    
    <li>Collection</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mongodb/mongo-php-library" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mongodbcollection">MongoDB\Collection<a class="headerlink" href="#mongodbcollection" title="Permanent link">&para;</a></h1>
<p><code>MongoDB\Collection</code> is perhaps the most useful class in this library. It
provides methods for common operations on a collection, such as inserting
documents, querying, updating, counting, etc.</p>
<p>A Collection may be constructed directly (using the extension&rsquo;s Manager class)
or selected from the library&rsquo;s Client class. It supports the following options:</p>
<ul>
<li><a href="http://php.net/mongodb-driver-readconcern">readConcern</a></li>
<li><a href="http://php.net/mongodb-driver-readpreference">readPreference</a></li>
<li><a href="http://php.net/manual/en/mongodb.persistence.php#mongodb.persistence.typemaps">typeMap</a></li>
<li><a href="http://php.net/mongodb-driver-writeconcern">writeConcern</a></li>
</ul>
<p>If any options are omitted, they will be inherited from the Manager constructor
argument or object from which the Collection was selected.</p>
<p>Operations within the Collection class (e.g. <code>find()</code>, <code>insertOne()</code>) will
generally inherit the Collection&rsquo;s options. One notable exception to this rule
is that <code>aggregate()</code> (when not using a cursor) and the <code>findAndModify</code> variants
do not yet support a type map option due to a driver limitation. This means that
they will return BSON documents and arrays as <code>stdClass</code> objects and PHP arrays,
respectively.</p>
<h2 id="collection-level-operations">Collection-level Operations<a class="headerlink" href="#collection-level-operations" title="Permanent link">&para;</a></h2>
<p>The Collection class has methods for collection-level operations, such as
dropping the collection, CRUD operations, or managing the collection&rsquo;s indexes.</p>
<h3 id="dropping-the-collection">Dropping the Collection<a class="headerlink" href="#dropping-the-collection" title="Permanent link">&para;</a></h3>
<pre><code>$collection = (new MongoDB\Client)-&gt;demo-&gt;zips;

$result = $collection-&gt;drop();
var_dump($result);
</code></pre>

<p>The above example would output something similar to:</p>
<pre><code>object(MongoDB\Model\BSONDocument)#11 (1) {
  [&quot;storage&quot;:&quot;ArrayObject&quot;:private]=&gt;
  array(3) {
    [&quot;ns&quot;]=&gt;
    string(9) &quot;demo.zips&quot;
    [&quot;nIndexesWas&quot;]=&gt;
    int(1)
    [&quot;ok&quot;]=&gt;
    float(1)
  }
}
</code></pre>

<h2 id="crud-operations">CRUD Operations<a class="headerlink" href="#crud-operations" title="Permanent link">&para;</a></h2>
<p>CRUD is an acronym for Create, Read, Update, and Delete. The Collection class
implements MongoDB&rsquo;s cross-driver
<a href="https://github.com/mongodb/specifications/blob/master/source/crud/crud.rst">CRUD specification</a>,
which defines a common API for collection-level read and write methods.</p>
<p>Each method on the Collection class corresponds to a particular Operation class
within the library. The Collection&rsquo;s method merely merges in relevant options
(e.g. read preferences, type maps). Documentation for each CRUD method and its
options may be found in either the CRUD specification or those Operation
classes.</p>
<h3 id="api-differences-from-the-legacy-driver">API Differences from the Legacy Driver<a class="headerlink" href="#api-differences-from-the-legacy-driver" title="Permanent link">&para;</a></h3>
<p>The CRUD API has some notable differences from the legacy driver&rsquo;s
<a href="http://php.net/mongocollection">MongoCollection</a> class:</p>
<ul>
<li><code>insert()</code> and <code>batchInsert()</code> have been renamed to <code>insertOne()</code> and
   <code>insertMany()</code>, respectively.</li>
<li><code>update()</code> has been split into <code>updateOne()</code>, <code>updateMany()</code>, and
   <code>replaceOne()</code>.</li>
<li><code>remove()</code> has been split into <code>deleteOne()</code> and <code>deleteMany()</code>.</li>
<li><code>findAndModify()</code> has been split into <code>findOneAndDelete()</code>,
   <code>findOneAndReplace()</code>, and <code>findOneAndUpdate()</code>.</li>
<li><code>save()</code>, which was syntactic sugar for an insert or upsert operation, has
    been removed in favor of explicitly using <code>insertOne()</code> or <code>replaceOne()</code>
    (with the <code>upsert</code> option).</li>
<li><code>aggregate()</code> and <code>aggregateCursor()</code> have been consolidated into a single
   <code>aggregate()</code> method.</li>
<li>A general-purpose <code>bulkWrite()</code> method replaces the legacy driver&rsquo;s
   <a href="http://php.net/mongowritebatch"><code>MongoWriteBatch</code></a> class.</li>
</ul>
<p>The general rule in designing our new API was that explicit method names were
preferable to overloaded terms found in the old API. For instance, <code>save()</code> and
<code>findAndModify()</code> had two or three very different modes of operation, depending
on their arguments. These new methods names also distinguish between
<a href="https://docs.mongodb.org/manual/tutorial/modify-documents/#update-specific-fields-in-a-document">updating specific fields</a>
and <a href="https://docs.mongodb.org/manual/tutorial/modify-documents/#replace-the-document">full-document replacement</a>.</p>
<h3 id="finding-one-or-more-documents">Finding One or More Document(s)<a class="headerlink" href="#finding-one-or-more-documents" title="Permanent link">&para;</a></h3>
<p>The <code>findOne()</code> and <code>find()</code> methods may be used to query for one or multiple
documents.</p>
<pre><code>$collection = (new MongoDB\Client)-&gt;demo-&gt;zips;

$document = $collection-&gt;findOne(['_id' =&gt; '94301']);
var_dump($document);
</code></pre>

<p>The above example would output something similar to:</p>
<pre><code>object(MongoDB\Model\BSONDocument)#13 (1) {
  [&quot;storage&quot;:&quot;ArrayObject&quot;:private]=&gt;
  array(5) {
    [&quot;_id&quot;]=&gt;
    string(5) &quot;94301&quot;
    [&quot;city&quot;]=&gt;
    string(9) &quot;PALO ALTO&quot;
    [&quot;loc&quot;]=&gt;
    object(MongoDB\Model\BSONArray)#12 (1) {
      [&quot;storage&quot;:&quot;ArrayObject&quot;:private]=&gt;
      array(2) {
        [0]=&gt;
        float(-122.149685)
        [1]=&gt;
        float(37.444324)
      }
    }
    [&quot;pop&quot;]=&gt;
    int(15965)
    [&quot;state&quot;]=&gt;
    string(2) &quot;CA&quot;
  }
}
</code></pre>

<p>The <code>find()</code> method returns a
<a href="http://php.net/mongodb-driver-cursor"><code>MongoDB\Driver\Cursor</code></a> object, which
may be iterated upon to access all matched documents.</p>
<h2 id="index-management">Index Management<a class="headerlink" href="#index-management" title="Permanent link">&para;</a></h2>
<p>The Collection class implements MongoDB&rsquo;s cross-driver
<a href="https://github.com/mongodb/specifications/blob/master/source/index-management.rst">Index Management</a>
and
<a href="https://github.com/mongodb/specifications/blob/master/source/enumerate-indexes.rst">Enumerating Indexes</a>
specifications, which defines a common API for index-related methods.</p>
<h3 id="creating-indexes">Creating Indexes<a class="headerlink" href="#creating-indexes" title="Permanent link">&para;</a></h3>
<pre><code>$collection = (new MongoDB\Client)-&gt;demo-&gt;zips;

$result = $collection-&gt;createIndex(['state' =&gt; 1]);
var_dump($result);
</code></pre>

<p>The above example would output something similar to:</p>
<pre><code>string(7) &quot;state_1&quot;
</code></pre>

<h3 id="dropping-indexes">Dropping Indexes<a class="headerlink" href="#dropping-indexes" title="Permanent link">&para;</a></h3>
<pre><code>$collection = (new MongoDB\Client)-&gt;demo-&gt;zips;

$result = $collection-&gt;dropIndex('state_1');
var_dump($result);
</code></pre>

<p>The above example would output something similar to:</p>
<pre><code>object(MongoDB\Model\BSONDocument)#11 (1) {
  [&quot;storage&quot;:&quot;ArrayObject&quot;:private]=&gt;
  array(2) {
    [&quot;nIndexesWas&quot;]=&gt;
    int(2)
    [&quot;ok&quot;]=&gt;
    float(1)
  }
}
</code></pre>

<h3 id="enumerating-indexes">Enumerating Indexes<a class="headerlink" href="#enumerating-indexes" title="Permanent link">&para;</a></h3>
<pre><code>/* listIndexes() returns an iterator of MongoDB\Model\IndexInfo objects */
$collection = (new MongoDB\Client)-&gt;demo-&gt;zips;

foreach ($collection-&gt;listIndexes() as $indexInfo) {
    var_dump($indexInfo);
}
</code></pre>

<p>The above example would output something similar to:</p>
<pre><code>object(MongoDB\Model\IndexInfo)#4 (4) {
  [&quot;v&quot;]=&gt;
  int(1)
  [&quot;key&quot;]=&gt;
  array(1) {
    [&quot;_id&quot;]=&gt;
    int(1)
  }
  [&quot;name&quot;]=&gt;
  string(4) &quot;_id_&quot;
  [&quot;ns&quot;]=&gt;
  string(9) &quot;demo.zips&quot;
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../database/" class="btn btn-neutral" title="Database"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../database/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>

</body>
</html>
